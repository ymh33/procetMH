package com.oracle.samil.Acontroller;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import com.oracle.samil.Amodel.Emp;
import com.oracle.samil.Amodel.Sal;
import com.oracle.samil.MhService.Paging;
import com.oracle.samil.MhService.SalService;

import lombok.RequiredArgsConstructor;

@Controller
@RequiredArgsConstructor
@RequestMapping(value="/mh")
public class MhSalController {
	private final SalService ss;
		
		@GetMapping(value = "/sal_join")
		public String sal_join (){
			System.out.println("mh sal_join play~");
			return "mh/sal_join";
		}

		@GetMapping(value = "/admin_sal_set")
		public String empList (Emp emp, Model model){
			int totalSal =  ss.totalSal();
			String currentPage = "1";
			
			Paging page = new Paging(totalSal, emp.getCurrentPage());
			emp.setStart(page.getStart());
			emp.setEnd(page.getEnd());


			System.out.println("Sal->" + totalSal);
			List<Emp> listEmp = ss.totalEmp(emp);
			model.addAttribute("totalSal", totalSal);
			model.addAttribute("listEmp", listEmp);
			model.addAttribute("page", page);
			
			System.out.println("listEmp->" + listEmp);
			
			return "mh/admin_sal_set";
			
		}
		@ResponseBody
	    @PostMapping("/getDeptName")
		  public ResponseEntity<Map<String, String>> getDeptName(@RequestParam("empno") String empno) {
	        // empno가 null이거나 빈 값이 아닌지 체크
	        if (empno == null || empno.trim().isEmpty()) {
	            return ResponseEntity.badRequest().body(null); // 잘못된 요청
	        }

	        // empno로 부서명을 조회하는 로직 (예시: "IT 부서" 반환)
	        String deptName = "IT 부서";  // 예시로 고정된 값 사용
	        Map<String, String> response = new HashMap<>();
	        response.put("deptName", deptName);
	        
	        return ResponseEntity.ok(response);  // JSON 형식으로 응답
		}
		
	
		
		@GetMapping(value = "/admin_sal_give")
		public String sal_give (){
			System.out.println("mh admin_sal_give play~");
			return "mh/admin_sal_give";
		}
		
		@GetMapping(value = "/admin_sal_list")
		public String sal_list (){
			System.out.println("mh admin_sal_list play~");
			return "mh/admin_sal_list";
		}

	
}
